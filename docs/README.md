# Мета-Игровая Платформа LucasTeam

Telegram бот "Мета-Игровая Платформа" - это многофункциональная система, объединяющая:
- Банк-аггрегатор для сбора валют из различных игровых ботов
- Магазин внутриигровых товаров и привилегий
- Систему мини-игр (Города, Слова, Уровни GD)
- Мастерскую для проведения D&D сессий
- Социальные функции и мотивационные механизмы

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd Банк-аггрегатор
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Укажите токен вашего Telegram бота в файле `.env`:
```
BOT_TOKEN=ваш_токен_бота_здесь
ADMIN_USER_IDS=2091908459
```

## Запуск

### Запуск бота:
```bash
python main.py
```

### Инициализация системы:
```bash
python initialize_system.py
```

### Запуск тестов:
```bash
python test_system.py
```

## Настройка

### Конфигурация
Основные настройки находятся в файле `config.py`:
- Коэффициенты конвертации валют
- Параметры безопасности
- Конфигурация игр
- Параметры D&D системы

### Администрирование
Для администрирования системы используйте следующие команды:

#### Управление банком:
- `/admin_rates` - Просмотр коэфициентов конвертации
- `/admin_rate <игра> <новый_коэффициент>` - Изменение коэффициента
- `/admin_merge <пользователь1> <пользователь2>` - Объединение аккаунтов
- `/admin_transactions <пользователь>` - История транзакций
- `/admin_balances` - Топ пользователей по балансу
- `/admin_users` - Список пользователей

#### Управление магазином:
- `/admin_shop_add` - Добавление товара (в разработке)
- `/admin_shop_edit <id>` - Редактирование товара (в разработке)
- `/admin_shop_stats` - Статистика магазина (в разработке)

#### Управление играми:
- `/admin_games_stats` - Статистика по играм
- `/admin_reset_game <игра>` - Сброс состояния игры (в разработке)
- `/admin_ban_player <пользователь> <игра>` - Бан игрока (в разработке)

#### Системный мониторинг:
- `/admin_health` - Проверка здоровья системы
- `/admin_errors` - Просмотр ошибок
- `/admin_backup` - Ручное резервное копирование
- `/admin_cleanup` - Очистка устаревших данных

## Функциональность

### Банк-аггрегатор
- Автоматический парсинг сообщений из игр Shmalala, GD Cards, True Mafia, Bunker RP
- Конвертация игровой валюты в банковские монеты по настраиваемым коэффициентам
- Поддержка различных типов активностей (битвы, крокодил, рыбалка, и т.д.)

### Магазин
- Категории товаров: стикеры, привилегии, бусты, кастомный контент
- Система лимитов и кулдаунов
- Реальная активация купленных товаров
- История покупок

### Мини-игры
- Игра "Города" - классическая игра в города с начислением монет
- "Слова, которые могут убить" - придумывание убийственных слов
- "Уровни GD" - аналог игры в города, но с уровнями Geometry Dash

### D&D Мастерская
- Создание и проведение D&D сессий
- Управление персонажами
- Бросок костей с модификаторами
- Система квестов

### Социальные функции
- Система друзей
- Подарки между пользователями
- Кланы и гильдии
- Рейтинги и достижения

### Мотивационная система
- Ежедневные бонусы с прогрессивными множителями
- Система заданий
- Достижения и награды

## Структура проекта

```
.
├── bot.py                    # Основной файл бота
├── main.py                   # Точка входа
├── database.py               # Модели базы данных
├── config.py                 # Конфигурация
├── bank_system.py            # Банковская система
├── shop_system.py            # Система магазина
├── games_system.py           # Система игр
├── dnd_system.py             # D&D система
├── motivation_system.py      # Система мотивации
├── social_system.py          # Социальная система
├── achievements.py           # Система достижений
├── notification_system.py    # Система уведомлений
├── parsers.py                # Парсеры игровых сообщений
├── user_manager.py           # Менеджер пользователей
├── monitoring_system.py      # Система мониторинга
├── backup_system.py          # Система бэкапов
├── error_handling.py         # Обработка ошибок
├── initialize_system.py      # Инициализация системы
├── test_system.py            # Тестирование системы
├── SYSTEM_OVERVIEW.md        # Обзор системы
├── requirements.txt          # Зависимости
├── .env.example             # Пример файла конфигурации
└── README.md                # Данный файл
```

## Технические характеристики

- **Язык**: Python 3.9+
- **Фреймворк**: python-telegram-bot 20.0+
- **База данных**: SQLite 3.x (с возможностью миграции на PostgreSQL)
- **ORM**: SQLAlchemy 2.0+
- **Логирование**: structlog

## Безопасность

- Валидация всех входящих данных
- Защита от SQL-инъекций
- Ограничение количества транзакций в час
- Проверка дубликатов транзакций
- Система алертов и мониторинга

## Поддержка и развитие

Система разработана с учетом будущего масштабирования и может быть расширена дополнительными модулями, интеграциями с другими платформами и усовершенствованными механиками игр.

Для получения поддержки или сообщения об ошибках, создайте issue в репозитории.